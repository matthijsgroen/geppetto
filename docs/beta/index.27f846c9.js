function t(t){return t&&t.__esModule?t.default:t}function e(t){return t&&t.__esModule?t.default:t}var a={};const o=Math.pow(2,-52),n=new Uint32Array(512);class r{static from(t,e=g,a=w){const o=t.length,n=new Float64Array(2*o);for(let r=0;r<o;r++){const o=t[r];n[2*r]=e(o),n[2*r+1]=a(o)}return new r(n)}constructor(t){const e=t.length>>1;if(e>0&&"number"!=typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const a=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*a),this._halfedges=new Int32Array(3*a),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:a,_hullTri:n,_hullHash:r}=this,i=t.length>>1;let s=1/0,l=1/0,u=-1/0,c=-1/0;for(let e=0;e<i;e++){const a=t[2*e],o=t[2*e+1];a<s&&(s=a),o<l&&(l=o),a>u&&(u=a),o>c&&(c=o),this._ids[e]=e}const d=(s+u)/2,f=(l+c)/2;let g,w,M,V=1/0;for(let e=0;e<i;e++){const a=m(d,f,t[2*e],t[2*e+1]);a<V&&(g=e,V=a)}const E=t[2*g],T=t[2*g+1];V=1/0;for(let e=0;e<i;e++){if(e===g)continue;const a=m(E,T,t[2*e],t[2*e+1]);a<V&&a>0&&(w=e,V=a)}let N=t[2*w],v=t[2*w+1],L=1/0;for(let e=0;e<i;e++){if(e===g||e===w)continue;const a=y(E,T,N,v,t[2*e],t[2*e+1]);a<L&&(M=e,L=a)}let b=t[2*M],k=t[2*M+1];if(L===1/0){for(let e=0;e<i;e++)this._dists[e]=t[2*e]-t[0]||t[2*e+1]-t[1];h(this._ids,this._dists,0,i-1);const e=new Uint32Array(i);let a=0;for(let t=0,o=-1/0;t<i;t++){const n=this._ids[t];this._dists[n]>o&&(e[a++]=n,o=this._dists[n])}return this.hull=e.subarray(0,a),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(p(E,T,N,v,b,k)){const t=w,e=N,a=v;w=M,N=b,v=k,M=t,b=e,k=a}const x=function(t,e,a,o,n,r){const i=a-t,s=o-e,l=n-t,u=r-e,m=i*i+s*s,c=l*l+u*u,p=.5/(i*u-s*l);return{x:t+(u*m-s*c)*p,y:e+(i*c-l*m)*p}}(E,T,N,v,b,k);this._cx=x.x,this._cy=x.y;for(let e=0;e<i;e++)this._dists[e]=m(t[2*e],t[2*e+1],x.x,x.y);h(this._ids,this._dists,0,i-1),this._hullStart=g;let B=3;a[g]=e[M]=w,a[w]=e[g]=M,a[M]=e[w]=g,n[g]=0,n[w]=1,n[M]=2,r.fill(-1),r[this._hashKey(E,T)]=g,r[this._hashKey(N,v)]=w,r[this._hashKey(b,k)]=M,this.trianglesLen=0,this._addTriangle(g,w,M,-1,-1,-1);for(let i,s,l=0;l<this._ids.length;l++){const u=this._ids[l],m=t[2*u],c=t[2*u+1];if(l>0&&Math.abs(m-i)<=o&&Math.abs(c-s)<=o)continue;if(i=m,s=c,u===g||u===w||u===M)continue;let d=0;for(let t=0,e=this._hashKey(m,c);t<this._hashSize&&(d=r[(e+t)%this._hashSize],-1===d||d===a[d]);t++);d=e[d];let y,h=d;for(;y=a[h],!p(m,c,t[2*h],t[2*h+1],t[2*y],t[2*y+1]);)if(h=y,h===d){h=-1;break}if(-1===h)continue;let f=this._addTriangle(h,u,a[h],-1,-1,n[h]);n[u]=this._legalize(f+2),n[h]=f,B++;let V=a[h];for(;y=a[V],p(m,c,t[2*V],t[2*V+1],t[2*y],t[2*y+1]);)f=this._addTriangle(V,u,y,n[u],-1,n[V]),n[u]=this._legalize(f+2),a[V]=V,B--,V=y;if(h===d)for(;y=e[h],p(m,c,t[2*y],t[2*y+1],t[2*h],t[2*h+1]);)f=this._addTriangle(y,u,h,-1,n[h],n[y]),this._legalize(f+2),n[y]=f,a[h]=h,B--,h=y;this._hullStart=e[u]=h,a[h]=e[V]=u,a[u]=V,r[this._hashKey(m,c)]=u,r[this._hashKey(t[2*h],t[2*h+1])]=h}this.hull=new Uint32Array(B);for(let t=0,e=this._hullStart;t<B;t++)this.hull[t]=e,e=a[e];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(function(t,e){const a=t/(Math.abs(t)+Math.abs(e));return(e>0?3-a:1+a)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:a,coords:o}=this;let r=0,i=0;for(;;){const s=a[t],l=t-t%3;if(i=l+(t+2)%3,-1===s){if(0===r)break;t=n[--r];continue}const u=s-s%3,m=l+(t+1)%3,c=u+(s+2)%3,p=e[i],y=e[t],h=e[m],f=e[c];if(d(o[2*p],o[2*p+1],o[2*y],o[2*y+1],o[2*h],o[2*h+1],o[2*f],o[2*f+1])){e[t]=f,e[s]=p;const o=a[c];if(-1===o){let e=this._hullStart;do{if(this._hullTri[e]===c){this._hullTri[e]=t;break}e=this._hullPrev[e]}while(e!==this._hullStart)}this._link(t,o),this._link(s,a[i]),this._link(i,c);const l=u+(s+1)%3;r<n.length&&(n[r++]=l)}else{if(0===r)break;t=n[--r]}}return i}_link(t,e){this._halfedges[t]=e,-1!==e&&(this._halfedges[e]=t)}_addTriangle(t,e,a,o,n,r){const i=this.trianglesLen;return this._triangles[i]=t,this._triangles[i+1]=e,this._triangles[i+2]=a,this._link(i,o),this._link(i+1,n),this._link(i+2,r),this.trianglesLen+=3,i}}var i,s,l,u;function m(t,e,a,o){const n=t-a,r=e-o;return n*n+r*r}function c(t,e,a,o,n,r){const i=(o-e)*(n-t),s=(a-t)*(r-e);return Math.abs(i-s)>=33306690738754716e-32*Math.abs(i+s)?i-s:0}function p(t,e,a,o,n,r){return(c(n,r,t,e,a,o)||c(t,e,a,o,n,r)||c(a,o,n,r,t,e))<0}function d(t,e,a,o,n,r,i,s){const l=t-i,u=e-s,m=a-i,c=o-s,p=n-i,d=r-s,y=m*m+c*c,h=p*p+d*d;return l*(c*h-y*d)-u*(m*h-y*p)+(l*l+u*u)*(m*d-c*p)<0}function y(t,e,a,o,n,r){const i=a-t,s=o-e,l=n-t,u=r-e,m=i*i+s*s,c=l*l+u*u,p=.5/(i*u-s*l),d=(u*m-s*c)*p,y=(i*c-l*m)*p;return d*d+y*y}function h(t,e,a,o){if(o-a<=20)for(let n=a+1;n<=o;n++){const o=t[n],r=e[o];let i=n-1;for(;i>=a&&e[t[i]]>r;)t[i+1]=t[i--];t[i+1]=o}else{let n=a+1,r=o;f(t,a+o>>1,n),e[t[a]]>e[t[o]]&&f(t,a,o),e[t[n]]>e[t[o]]&&f(t,n,o),e[t[a]]>e[t[n]]&&f(t,a,n);const i=t[n],s=e[i];for(;;){do{n++}while(e[t[n]]<s);do{r--}while(e[t[r]]>s);if(r<n)break;f(t,n,r)}t[a+1]=t[r],t[r]=i,o-n+1>=r-a?(h(t,e,n,o),h(t,e,a,r-1)):(h(t,e,a,r-1),h(t,e,n,o))}}function f(t,e,a){const o=t[e];t[e]=t[a],t[a]=o}function g(t){return t[0]}function w(t){return t[1]}i=a,s="default",l=function(){return r},Object.defineProperty(i,s,{get:l,enumerable:!0}),u=a,Object.defineProperty(u,"__esModule",{value:!0});var M=e(a);const V=t=>t.reduce(((t,e)=>t.concat(e)),[]),E=t=>({data:new Float32Array(V(t)),length:t.length,stride:void 0===t[0]?0:t[0].length}),T=t=>"folder"===t.type||"sprite"===t.type,N=(t,e,a=[])=>{for(const o of t){e(o,a);for(const t of o.mutationVectors)e(t,[...a,o]);"folder"===o.type&&N(o.items,e,[...a,o])}},v={translate:1,stretch:2,rotate:3,deform:4,opacity:5,lightness:6,colorize:7,saturation:8},L=(t,e)=>{const a=t[t.length-1];if(T(a)){const o=e?a.mutationVectors.indexOf(e):-1;if(o>0)return a.mutationVectors[o-1];for(let a=t.length-(e?2:1);a>=0;a--){const e=t[a];if(e&&T(e)&&e.mutationVectors.length>0)return e.mutationVectors[e.mutationVectors.length-1]}}return null},b=t=>{const e=t.controls.map((t=>t.name));return t.animations.map((t=>{const a=[],o=[];return t.keyframes.reduce(((t,e)=>(e.event&&o.push([e.time,e.event]),t.concat(Object.keys(e.controlValues)))),[]).filter(((t,e,a)=>a.indexOf(t)===e)).forEach((o=>{const n=[];t.keyframes.forEach((t=>{const e=t.controlValues[o];void 0!==e&&n.push([t.time,e])})),a.push([e.indexOf(o),new Float32Array(V(n))])})),{name:t.name,duration:0===t.keyframes.length?0:t.keyframes[t.keyframes.length-1].time,looping:t.looping,tracks:a,events:o}}))};let k;var x;(x=k||(k={}))[x.MULTIPLY=0]="MULTIPLY",x[x.ADD=1]="ADD",x[x.HUE=2]="HUE";const B=t=>t===v.stretch||t===v.lightness||t===v.saturation||t===v.opacity?k.MULTIPLY:t===v.colorize?k.HUE:k.ADD,_=["1.0","1.1"];var A=t=>{if(!_.includes(t.version))throw new Error("Version ".concat(t.version," files are not supported"));const e=[],a=[],o=[];N(t.shapes,(t=>{if("sprite"!==t.type)return;const n=(t=>{let e=1/0,a=-1/0,o=1/0,n=-1/0;return t.points.forEach((([t,r])=>{e=t<e?t:e,a=t>a?t:a,o=r<o?r:o,n=r>n?r:n})),[(e+a)/2,(o+n)/2]})(t),r=(i=t.points,M.from(i).triangles);var i;const s=[...t.translate,.1*e.length],l=a.length;e.push({name:t.name,start:2*o.length,amount:r.length,mutator:0,x:s[0],y:s[1],z:1e-4*s[2]-.9}),t.points.forEach((([t,e])=>{a.push([t-n[0],e-n[1],t,e])})),r.forEach((t=>{o.push(t+l)}))}));const n=(t=>{const e=[],a=[],o={};N(t,((t,n)=>{if((t=>(t=>"deform"===t.type||"rotate"===t.type||"translate"===t.type||"stretch"===t.type||"opacity"===t.type)(t)||(t=>"lightness"===t.type||"saturation"===t.type||"colorize"===t.type)(t))(t)){const i=[v[(r=t).type],r.origin[0],r.origin[1],"deform"===r.type||"translate"===r.type?r.radius:-1],s=a.length;a.push(i);const l=L(n,t),u=null===l?-1:e.findIndex((t=>t.name===l.name));e.push({name:t.name,index:s,parent:u}),o[t.name]=u}var r}));const n={};N(t,((t,a)=>{if(T(t)){const o=L(a.concat(t)),r=null===o?-1:e.findIndex((t=>t.name===o.name));n[t.name]=r}}));const r=new Int32Array(a.length);return e.forEach(((t,e)=>{r[e]=t.parent})),{mutatorMapping:o,parentList:r,vectorSettings:a,shapeMutatorMapping:n}})(t.shapes),r=n.parentList.length,i=Object.keys(n.mutatorMapping),s=[],l=new Float32Array(2*r);Object.entries(t.defaultFrame).forEach((([t,e])=>{const a=i.indexOf(t);-1!==a&&(l[2*a]=e[0],l[2*a+1]=e[1])}));const u=[],m=[],c=[];e.forEach((t=>{t.mutator=n.shapeMutatorMapping[t.name]})),e.sort(((t,e)=>(e.z||0)-(t.z||0)));const p=new Float32Array(t.controls.length),d=t.controls.reduce(((e,a,o)=>{const n=a.steps.reduce(((t,e)=>t.concat(Object.keys(e).filter((e=>!t.includes(e))))),[]);return s.push({name:a.name,steps:a.steps.length}),p[o]=t.controlValues[a.name],n.forEach((o=>{const n=i.indexOf(o),r=a.steps.map((t=>t[o])),s=(null==t?void 0:t.controls.findIndex((t=>t.name===a.name)))||0,l={name:a.name,controlIndex:s,valueStartIndex:0,values:r,stepType:0};e={...e,[n]:(e[n]||[]).concat(l)}})),e}),{});c.length=n.vectorSettings.length,c.fill([0,0]);let y=0;const h=[];return Object.entries(d).forEach((([t,e])=>{const a=parseInt(t,10);if(1===e.length){const t=e[0],o=n.vectorSettings[a][0];return void h.push({mutation:a,mixMode:B(o),control:t.controlIndex,stepType:t.stepType,trackX:new Float32Array(t.values.reduce(((t,e,a)=>t.concat(a,e[0])),[])),trackY:new Float32Array(t.values.reduce(((t,e,a)=>t.concat(a,e[1])),[]))})}if(0===e.length)return;for(const t of e)t.valueStartIndex=u.length,u.push(...t.values);const o=e.map((t=>[t.valueStartIndex,t.controlIndex,t.stepType]));c[a]=[m.length,o.length],y=Math.max(y,o.length),m.push(...o)})),{directControls:h,mutators:E(n.vectorSettings),mutatorParents:{data:n.parentList,length:n.parentList.length,stride:1},mutationValues:{data:l,length:n.parentList.length,stride:2},controlMutationValues:E(u),mutationValueIndices:E(m),controlMutationIndices:E(c),defaultControlValues:p,shapeVertices:E(a),shapeIndices:new Uint16Array(o),shapes:e,controls:s,maxIteration:y,animations:b(t)}},S=e("precision mediump float;\n#define GLSLIFY 1\nvarying mediump vec2 vTextureCoord;varying lowp float vOpacity;varying lowp float vBrightness;varying lowp float vSaturation;varying lowp float vTargetHue;varying lowp float vTargetSaturation;uniform sampler2D uSampler;uniform mediump vec2 uTextureDimensions;float A(vec3 B){lowp float C=min(min(B.r,B.g),B.b);lowp float D=max(max(B.r,B.g),B.b);return(D+C)/2.;}float E(lowp float F,lowp float G,lowp float H){if(H<0.)H+=1.;else if(H>1.)H-=1.;lowp float I;if((6.*H)<1.)I=F+(G-F)*6.*H;else if((2.*H)<1.)I=G;else if((3.*H)<2.)I=F+(G-F)*((2./3.)-H)*6.;else I=F;return I;}vec3 J(vec3 K){lowp vec3 L;if(K.y==0.)L=vec3(K.z);else{lowp float G;if(K.z<0.5)G=K.z*(1.+K.y);else G=(K.z+K.y)-(K.y*K.z);float F=2.*K.z-G;L.r=E(F,G,K.x+(1./3.));L.g=E(F,G,K.x);L.b=E(F,G,K.x-(1./3.));}return L;}void main(void){highp vec2 M=vTextureCoord.xy/uTextureDimensions;mediump vec4 N=texture2D(uSampler,M);vec3 B=N.rgb;float O=A(B);B=mix(B,J(vec3(vTargetHue,vTargetSaturation,O)),1.-vSaturation)*vBrightness;gl_FragColor=vec4(B*N.a*vOpacity,N.a*vOpacity);}"),R=e("#define GLSLIFY 1\n#define A 0.017453292519943295\nuniform vec2 viewport;uniform vec3 basePosition;uniform vec3 translate;uniform float mutation;uniform vec4 scale;uniform vec2 uMutValues[MAX_MUT];uniform vec4 uMutVectors[MAX_MUT];uniform int uMutParent[MAX_MUT];attribute vec2 coordinates;attribute vec2 aTextureCoord;varying lowp vec2 vTextureCoord;varying lowp float vOpacity;varying lowp float vBrightness;varying lowp float vSaturation;varying lowp float vTargetHue;varying lowp float vTargetSaturation;mat4 B=mat4(2./viewport.x,0,0,0,0,-2./viewport.y,0,0,0,0,1,0,-1,+1,0,1);float C(float D,float E,float F){float G=abs(D-E);float H=D;float I=E;if(D<E&&abs(D+1.-E)<G){H=D+1.;}if(D>E&&abs(E-D+1.)<G){I=E+1.;}return mod(mix(H,I,F),1.);}vec2 J(int K,int L){vec2 M=uMutValues[K];vec2 N=uControlMutIndices[K];int O=int(N.x);int P=int(N.y);if(P==0){return M;}for(int Q=0;Q<MAX_IT;Q++){if(Q<P){vec3 R=uMutValueIndices[O+Q];float S=uControlValues[int(R.y)];int T=int(floor(R.x+S));int U=int(ceil(R.x+S));float V=S-floor(S);vec2 W=uControlMutValues[T];vec2 X=uControlMutValues[U];vec2 Y=mix(W,X,V);if(L==2||L==5||L==6||L==8){M*=Y;}else if(L==7){M=vec2(C(W[0],X[0],V),Y[1]);}else{M+=Y;}}else{return M;}}return M;}mat3 Z(mat3 a,int K){vec4 mutation=uMutVectors[K];int L=int(mutation.x);vec2 b=J(K,L);vec2 c=mutation.yz;vec3 M=a[0];vec3 d=a[1];vec3 e=a[2];if(L==1){float e=1.;if(mutation.a>0.&&distance(M.xy,c)>mutation.a){e=0.;}M=vec3(M.xy+b*e,M.z);}if(L==2){M=vec3(c.xy+vec2((M.x-c.x)*b.x,(M.y-c.y)*b.y),M.z);}if(L==3){float f=b.x*A;mat2 g=mat2(cos(f),sin(f),-sin(f),cos(f));M=vec3((M.xy-c)*g+c,M.z);}if(L==4){float e=1.-clamp(distance(M.xy,c),0.,mutation.a)/mutation.a;M=vec3(M.xy+b*e,M.z);}if(L==5){M=vec3(M.xy,M.z*b.x);}if(L==6){d=vec3(b.x*d.x,d.yz);}if(L==7){e=vec3(b.xy,e.z);}if(L==8){d=vec3(d.x,b.x*d.y,d.z);}return mat3(M,d,e);}mat3 h(mat3 a,int K){int i=K;mat3 M=a;for(int Q=0;Q<MAX_MUT;Q++){if(i==-1){return M;}M=Z(M,i);i=uMutParent[i];}return M;}void main(){mat3 O=mat3(coordinates+translate.xy,1.,1.,1.,0,0,0,0);mat3 j=h(O,int(mutation));vec3 k=j[0];vec3 l=j[1];vec3 m=j[2];vec4 n=B*vec4((k.xy+basePosition.xy)*scale.x,translate.z-basePosition.z,1.);gl_Position=vec4((n.xy+scale.ba)*scale.y,n.z,1.);vTextureCoord=aTextureCoord.xy;vOpacity=k.z;vBrightness=l.x;vSaturation=l.y;vTargetHue=m.x;vTargetSaturation=m.y;}");const C=(t,e,a)=>t*(1-a)+e*a,I=(t,e,a)=>{const o=Math.abs(t-e);let n=t,r=e;return t<e&&Math.abs(t+1-e)<o&&(n+=1),t>e&&Math.abs(e-t+1)<o&&(r+=1),C(n,r,a)%1},D=(t,e,a=0,o=C)=>{for(let n=0;n<t.length;n+=2)if(t[n]>e){const r=n>1?t[n-2]:0,i=n>1?t[n-1]:a,s=(e-r)/(t[n]-r);return o(i,t[n+1],s)}return t[t.length-1]},F={zoom:1,panX:0,panY:0,zIndex:0},U=t=>{const e=t.getContext("webgl",{premultipliedalpha:!0,depth:!0,antialias:!0,powerPreference:"low-power"});if(!e)throw new Error("Canvas has no webgl context available");return e};const P=t=>{const e=U(t),a=[];let o=[],n=[];return{render:()=>{e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.viewport(0,0,t.width,t.height)},addAnimation:(r,i,s,l)=>{const u=[e.TEXTURE0,e.TEXTURE1,e.TEXTURE2,e.TEXTURE3,e.TEXTURE4,e.TEXTURE5,e.TEXTURE6,e.TEXTURE7,e.TEXTURE8,e.TEXTURE9][s],[m,c,p]=((t,e)=>{const a=t.createProgram();if(!a)throw new Error("Failed to create shader program");const o=(t=>"\n#define MAX_MUT ".concat(t.mutators.length,"\n#define MAX_IT ").concat(t.maxIteration,"\nuniform vec2 uControlMutValues[").concat(t.controlMutationValues.length,"];\nuniform vec3 uMutValueIndices[").concat(t.mutationValueIndices.length,"];\nuniform vec2 uControlMutIndices[").concat(t.controlMutationIndices.length,"];\nuniform float uControlValues[").concat(t.controls.length,"];\n").concat(R,"\n"))(e),n=t.createShader(t.VERTEX_SHADER),r=t.createShader(t.FRAGMENT_SHADER);if(!n||!r)throw t.deleteProgram(a),t.deleteShader(n),t.deleteShader(r),new Error("Failed to create shader program");if(t.shaderSource(n,o),t.shaderSource(r,S),t.compileShader(n),t.compileShader(r),t.attachShader(a,n),t.attachShader(a,r),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS))throw console.error("Link failed: "+t.getProgramInfoLog(a)),console.error("vs info-log: "+t.getShaderInfoLog(n)),console.error("fs info-log: "+t.getShaderInfoLog(r)),new Error("Could not initialise shaders");return[a,n,r]})(e,r);e.useProgram(m);const d=((t,e,a)=>{const o=t.createTexture();return t.bindTexture(t.TEXTURE_2D,o),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,a),t.useProgram(e),t.uniform2f(t.getUniformLocation(e,"uTextureDimensions"),a.width,a.height),o})(e,m,i),y=e.getUniformLocation(m,"uMutParent");e.uniform1iv(y,r.mutatorParents.data);const h=((t,e)=>(a,o)=>{const n=t.getUniformLocation(e,a),r=o.stride;return 2==r?t.uniform2fv(n,o.data):3==r?t.uniform3fv(n,o.data):4==r&&t.uniform4fv(n,o.data),n})(e,m),f=h("uMutValues",r.mutationValues);h("uMutVectors",r.mutators),h("uControlMutValues",r.controlMutationValues),h("uMutValueIndices",r.mutationValueIndices),h("uControlMutIndices",r.controlMutationIndices);const g=e.getUniformLocation(m,"uControlValues");e.uniform1fv(g,r.defaultControlValues);const w=new Float32Array(r.defaultControlValues),M=new Float32Array(r.defaultControlValues),V=e.createBuffer(),E=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,V),e.bufferData(e.ARRAY_BUFFER,r.shapeVertices.data,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,E),e.bufferData(e.ELEMENT_ARRAY_BUFFER,r.shapeIndices,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null);const T=e.getUniformLocation(m,"basePosition"),N=e.getUniformLocation(m,"translate"),v=e.getUniformLocation(m,"mutation"),L=e.getUniformLocation(m,"viewport"),b=e.getUniformLocation(m,"scale"),x=e.getAttribLocation(m,"coordinates"),B=e.getAttribLocation(m,"aTextureCoord");let _=0,A=0,{zoom:C,panX:U,panY:P,zIndex:z}={...F,...l},O=[0,0],H=1;const X=[],W=r.animations.map((t=>t.name)),G=r.controls.map((t=>t.name)),Y=r.animations.map((t=>t.looping)),K=t=>{const e=X.findIndex((e=>e.name===t));if(-1===e)return;const a=X[e];let n=+new Date-a.startedAt+a.startAt;const i=r.animations[a.index];Y[a.index]&&(n%=i.duration),X.splice(e,1);for(const[t,e]of i.tracks){const a=D(e,n,w[t]);w[t]=a}for(const e of o)e(t)},j=t=>{const e=G.indexOf(t);if(-1===e)throw new Error("Control ".concat(t," does not exist in ").concat(G.join(",")));return e},J=t=>{const e=W.indexOf(t);if(-1===e)throw new Error("Track ".concat(t," does not exist in ").concat(W.join(",")));return e},Z={destroy:function(){e.deleteShader(c),e.deleteShader(p),e.deleteProgram(m),e.deleteTexture(d),e.deleteBuffer(V),e.deleteBuffer(E),a.splice(a.indexOf(Z),1)},setLooping:function(t,e){const a=J(e);Y[a]=t},startTrack:function(t,{startAt:e=0,speed:a=1}={}){const o=J(t),n=r.animations[o].tracks.map((([t])=>t));for(const t of X)r.animations[t.index].tracks.some((([t])=>n.includes(t)))&&K(W[t.index]);X.push({name:t,index:o,startAt:e,speed:a,startedAt:+new Date,iterationStartedAt:+new Date-e/a,lastRender:0})},stopTrack:K,setControlValue:(t,e)=>{const a=j(t),o=r.controls[a].steps-1;if(e<0||e>o)throw new Error("Control ".concat(t," value shoulde be between 0 and ").concat(o,". ").concat(e," is out of bounds."));for(const t of X)r.animations[t.index].tracks.some((([t])=>t===a))&&K(W[t.index]);w[a]=e,M[a]=e},getControlValue:t=>w[j(t)],setPanning:function(t,e){U=t,P=e},setZoom:function(t){C=t},setZIndex:function(t){z=t},render:function(){if(e.useProgram(m),e.bindBuffer(e.ARRAY_BUFFER,V),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,E),e.vertexAttribPointer(x,2,e.FLOAT,!1,4*Float32Array.BYTES_PER_ELEMENT,0),e.enableVertexAttribArray(x),e.vertexAttribPointer(B,2,e.FLOAT,!1,4*Float32Array.BYTES_PER_ELEMENT,2*Float32Array.BYTES_PER_ELEMENT),e.enableVertexAttribArray(B),t.width!==_||t.height!==A){const a=t.width,o=t.height,n=i.width/a>i.height/o;H=n?a/i.width:o/i.height,e.uniform2f(L,a,o),O=[a/2/H,o/2/H],_=t.width,A=t.height}e.uniform4f(b,H,C,U,P),e.activeTexture(u),e.bindTexture(e.TEXTURE_2D,d),e.uniform1i(e.getUniformLocation(m,"uSampler"),s),e.uniform3f(T,O[0],O[1],.01*z);const a=+new Date;for(const t of X){const e=(a-t.iterationStartedAt)*t.speed,o=r.animations[t.index],i=e%o.duration;if(o.duration<e){if(!Y[t.index]){K(o.name);continue}t.iterationStartedAt=a-i;for(const[t]of o.tracks)w[t]=M[t]}for(const[e,r]of o.events){const o=t.iterationStartedAt+e/t.speed;if(o<a&&o>t.lastRender)for(const a of n)a(r,t.name,e)}t.lastRender=a;for(const[t,e]of o.tracks){const a=D(e,i,w[t]);M[t]=a}}const o=Float32Array.from(r.mutationValues.data);for(const t of r.directControls){const e=M[t.control],a=D(t.trackX,e),n=D(t.trackY,e);if(t.mixMode===k.MULTIPLY)o[2*t.mutation]*=a,o[2*t.mutation+1]*=n;else if(t.mixMode===k.ADD)o[2*t.mutation]+=a,o[2*t.mutation+1]+=n;else{const a=D(t.trackX,e,0,I);o[2*t.mutation]=a,o[2*t.mutation+1]*=n}}e.uniform2fv(f,o),e.uniform1fv(g,M);for(const t of r.shapes)e.uniform3f(N,t.x,t.y,t.z),e.uniform1f(v,t.mutator),e.drawElements(e.TRIANGLES,t.amount,e.UNSIGNED_SHORT,t.start)},onTrackStopped:function(t){return o=o.concat(t),()=>{o=o.filter((e=>e!==t))}},onEvent:function(t){return n=n.concat(t),()=>{n=n.filter((e=>e!==t))}}};return a.push(Z),Z},destroy:function(){for(const t of a)t.destroy();a.length=0}}};var z=null;var O=function(){return z||(z=function(){try{throw new Error}catch(e){var t=(""+e.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(t)return(""+t[0]).replace(/^((?:https?|file|ftp):\/\/.+)\/[^/]+$/,"$1")+"/"}return"/"}()),z},H=t(O()+"colortest.ebfcbb5e.png"),X=t(JSON.parse('{"animations":[{"name":"Wheel","looping":true,"keyframes":[{"time":0,"controlValues":{"WheelRotate":1}},{"time":19200,"controlValues":{"WheelRotate":0}}]},{"name":"Tree","looping":true,"keyframes":[{"time":0,"controlValues":{"TreeLeaves1":0}},{"time":500,"controlValues":{"TreeLeaves2":0}},{"time":8000,"controlValues":{"TreeLeaves1":1}},{"time":8500,"controlValues":{"TreeLeaves2":1}},{"time":16000,"controlValues":{"TreeLeaves1":0,"TreeLeaves2":0.04}}]},{"name":"Bird","looping":true,"keyframes":[{"time":6000,"controlValues":{"Beak":0}},{"time":6200,"controlValues":{"Beak":1}},{"time":7000,"controlValues":{"Beak":1}},{"time":7200,"controlValues":{"Beak":0}}]},{"name":"Cloud1","looping":true,"keyframes":[{"time":0,"controlValues":{"Cloud1":0.5}},{"time":20000,"controlValues":{"Cloud1":1}},{"time":20001,"controlValues":{"Cloud1":0}},{"time":40000,"controlValues":{"Cloud1":0.5}}]},{"name":"Eyes","looping":true,"keyframes":[{"time":0,"controlValues":{"EyesBlink":0}},{"time":3000,"controlValues":{"EyesBlink":0}},{"time":3300,"controlValues":{"EyesBlink":1}},{"time":3500,"controlValues":{"EyesBlink":1}},{"time":3700,"controlValues":{"EyesBlink":0}}]},{"name":"ButterflyWings","looping":true,"keyframes":[{"time":300,"controlValues":{"ButterflyWings":1}},{"time":600,"controlValues":{"ButterflyWings":0}}]},{"name":"Smoke","looping":true,"keyframes":[{"time":0,"controlValues":{"Rook":0,"Smoke":0}},{"time":10000,"controlValues":{"Rook":1,"Smoke":1}}]},{"name":"Cloud2","looping":true,"keyframes":[{"time":0,"controlValues":{"Cloud2":0.8}},{"time":30000,"controlValues":{"Cloud2":0}},{"time":30001,"controlValues":{"Cloud2":1}},{"time":40000,"controlValues":{"Cloud2":0.8}}]},{"name":"Cloud3","looping":true,"keyframes":[{"time":0,"controlValues":{"Cloud3":0.2}},{"time":10000,"controlValues":{"Cloud3":0}},{"time":10001,"controlValues":{"Cloud3":1}},{"time":40000,"controlValues":{"Cloud3":0.2}}]},{"name":"WheelBlades","looping":true,"keyframes":[{"time":0,"controlValues":{"WheelBlades":0}},{"time":1600,"controlValues":{"WheelBlades":1}}]},{"name":"Water","looping":true,"keyframes":[{"time":0,"controlValues":{"Bubble":1.6,"Bubble2":0.9,"Bubble3":0.3}},{"time":400,"controlValues":{"Bubble":2}},{"time":401,"controlValues":{"Bubble":0}},{"time":1600,"controlValues":{"Bubble2":1.6,"Bubble3":0.9,"Bubble":0.3}},{"time":2000,"controlValues":{"Bubble2":2}},{"time":2001,"controlValues":{"Bubble2":0}},{"time":3200,"controlValues":{"Bubble3":1.6,"Bubble":0.9,"Bubble2":0.3}},{"time":3600,"controlValues":{"Bubble3":2}},{"time":3601,"controlValues":{"Bubble3":0}},{"time":4800,"controlValues":{"Bubble2":0.9,"Bubble3":0.3,"Bubble":1.6}}]},{"name":"Day night","looping":true,"keyframes":[{"time":0,"controlValues":{"DayNight":0}},{"time":4000,"controlValues":{"DayNight":0.36},"event":"evening"},{"time":15000,"controlValues":{"DayNight":2}},{"time":19000,"controlValues":{"DayNight":2},"event":"endNight"},{"time":25000,"controlValues":{"DayNight":3.16},"event":"morning"},{"time":34000,"controlValues":{"DayNight":4}},{"time":40000,"controlValues":{"DayNight":4}}]},{"name":"LightFlicker","looping":true,"keyframes":[{"time":630,"controlValues":{"Light":0.72}},{"time":1210,"controlValues":{"Light":0.78}},{"time":1870,"controlValues":{"Light":0.69}},{"time":2610,"controlValues":{"Light":0.89}}]},{"name":"LightOff","looping":false,"keyframes":[{"time":1260,"controlValues":{"Light":0}}]}],"controlValues":{"WheelRotate":0.78,"TreeLeaves1":0,"TreeLeaves2":0.19,"Beak":0,"Cloud1":0.5,"EyesBlink":0,"ButterflyWings":0,"Rook":1,"Cloud2":0.8,"Cloud3":1,"DayNight":4,"Butterflyturn":1,"ButterflyZoom":1,"ButterflyX":0.49,"ButterflyY":0.29,"ButterflyTurn":0,"WheelBlades":0.66,"Smoke":0,"Buble":1.46,"Bubble":0.3,"Bubble2":0.9,"Bubble3":1.56,"Light":0},"controls":[{"name":"Light","type":"slider","steps":[{"Opacity (2)":[0,0]},{"Opacity (2)":[1,0]}]},{"name":"DayNight","type":"slider","steps":[{"Lightness (1)":[1,1],"Colorize":[0.71,0.24],"Translation":[0,0],"Saturation (2)":[1,0],"Opacity":[1,1],"Lightness (4)":[1,1],"Saturation":[1,1],"Opacity (1)":[1,1],"Lightness":[1,1],"Saturation (1)":[0.8,0]},{"Lightness (1)":[0.6,0],"Colorize":[0.04,0.73],"Translation":[0,294],"Saturation (2)":[0.56,0],"Opacity":[0.13,0],"Lightness (4)":[0.75,0],"Saturation":[0.72,0],"Opacity (1)":[1,1],"Lightness":[0.46,0],"Saturation (1)":[1,1]},{"Lightness (1)":[0.28,0],"Colorize":[0.77,0.47],"Translation":[0,384],"Saturation (2)":[0.15,0],"Opacity":[0,0],"Lightness (4)":[0.28,0],"Saturation":[0.18,0],"Opacity (1)":[0,0],"Lightness":[0.07,0],"Saturation (1)":[1,1]},{"Lightness (1)":[0.4,0],"Colorize":[0.03,1],"Translation":[0,299],"Saturation (2)":[0.22,0],"Opacity":[0.17,0],"Lightness (4)":[0.84,0],"Saturation":[0.2,0],"Opacity (1)":[1,1],"Lightness":[0.29,0],"Saturation (1)":[1,1]},{"Lightness (1)":[1,0],"Colorize":[0.71,0.24],"Translation":[0,0],"Saturation (2)":[1,0],"Opacity":[1,0],"Lightness (4)":[1,0],"Saturation":[1,1],"Opacity (1)":[1,1],"Lightness":[1,1],"Saturation (1)":[0.8,0]}]},{"name":"Bubble3","type":"slider","steps":[{"New Mutator (40)":[-11,0]},{"New Mutator (40)":[-77,49]},{"New Mutator (40)":[-126,107]}]},{"name":"Bubble2","type":"slider","steps":[{"New Mutator (39)":[-9,2]},{"New Mutator (39)":[-75,51]},{"New Mutator (39)":[-130,110]}]},{"name":"Bubble","type":"slider","steps":[{"New Mutator (38)":[-19,0]},{"New Mutator (38)":[-85,43]},{"New Mutator (38)":[-149,115]}]},{"name":"WheelBlades","type":"slider","steps":[{"New Mutator (24)":[0,0],"New Mutator (25)":[1,0.8],"New Mutator (26)":[0,0],"New Mutator (27)":[1,0],"New Mutator (28)":[0,0],"New Mutator (29)":[1,1],"New Mutator (30)":[0,0],"New Mutator (31)":[0.65,1],"New Mutator (32)":[11,0],"New Mutator (35)":[33,0],"New Mutator (34)":[1,0.03],"New Mutator (33)":[0,0],"New Mutator (37)":[43,0]},{"New Mutator (24)":[-33,-19],"New Mutator (25)":[1,0.7],"New Mutator (26)":[10,0],"New Mutator (27)":[-31,-65],"New Mutator (28)":[13,0],"New Mutator (29)":[1,0.75],"New Mutator (30)":[-10,-83],"New Mutator (31)":[0.66,0.05],"New Mutator (32)":[0,0],"New Mutator (35)":[17,0],"New Mutator (34)":[1,-0.37],"New Mutator (33)":[9,-88],"New Mutator (37)":[-2,0]}]},{"name":"Smoke","type":"slider","steps":[{"New Mutator (16)":[0,0]},{"New Mutator (16)":[0,-128]}]},{"name":"ButterflyY","type":"slider","steps":[{"New Mutator (22)":[0,-216]},{"New Mutator (22)":[0,210]}]},{"name":"ButterflyX","type":"slider","steps":[{"New Mutator (22)":[-400,0]},{"New Mutator (22)":[200,0]}]},{"name":"ButterflyZoom","type":"slider","steps":[{"New Mutator (21)":[1,1]},{"New Mutator (21)":[0.5,0.5]}]},{"name":"ButterflyTurn","type":"slider","steps":[{"New Mutator (21)":[1,1]},{"New Mutator (21)":[-1,1]}]},{"name":"ButterflyWings","type":"slider","steps":[{"New Mutator (13)":[1,1],"New Mutator (14)":[1,1]},{"New Mutator (13)":[1,-1.05],"New Mutator (14)":[1,-0.4]}]},{"name":"EyesBlink","type":"slider","steps":[{"New Mutator (12)":[1,1]},{"New Mutator (12)":[0,0]}]},{"name":"Cloud1","type":"slider","steps":[{"New Mutator (11)":[1200,0]},{"New Mutator (11)":[-1300,0]}]},{"name":"Cloud2","type":"slider","steps":[{"New Mutator (19)":[-2101,0]},{"New Mutator (19)":[270,0]}]},{"name":"Cloud3","type":"slider","steps":[{"New Mutator (20)":[-546,0]},{"New Mutator (20)":[1753,0]}]},{"name":"Beak","type":"slider","steps":[{"New Mutator (7)":[0,0],"New Mutator (6)":[0,0]},{"New Mutator (7)":[-19,0],"New Mutator (6)":[7,0]}]},{"name":"TreeLeaves2","type":"slider","steps":[{"New Mutator (5)":[-42,0],"New Mutator (9)":[-11,0],"New Mutator (23)":[-12,0],"New Mutator (36)":[0,0]},{"New Mutator (5)":[48,0],"New Mutator (9)":[8,0],"New Mutator (23)":[13,0],"New Mutator (36)":[0,13]}]},{"name":"TreeLeaves1","type":"slider","steps":[{"New Mutator (4)":[-27,0],"New Mutator (8)":[-13,0],"New Mutator (10)":[-6,0]},{"New Mutator (4)":[40,0],"New Mutator (8)":[12,0],"New Mutator (10)":[11,0]}]},{"name":"WheelRotate","type":"slider","steps":[{"New Mutator (3)":[0,0],"New Mutator (2)":[0,0]},{"New Mutator (3)":[360,0],"New Mutator (2)":[360,0]}]}],"defaultFrame":{"New Mutator":[0.45,1],"New Mutator (1)":[0.45,1],"New Mutator (2)":[0,0],"New Mutator (3)":[90,0],"New Mutator (4)":[0,0],"New Mutator (5)":[0,0],"New Mutator (6)":[0,0],"New Mutator (7)":[0,0],"New Mutator (8)":[0,0],"New Mutator (9)":[0,0],"New Mutator (10)":[0,0],"New Mutator (12)":[1,0],"New Mutator (13)":[1,1],"New Mutator (14)":[1,0.85],"New Mutator (15)":[-41,0],"New Mutator (17)":[37,0],"New Mutator (18)":[23,0],"New Mutator (21)":[1,1],"New Mutator (23)":[0,0],"New Mutator (25)":[1,1],"New Mutator (26)":[0,0],"New Mutator (29)":[1,0.7],"New Mutator (28)":[10,0],"New Mutator (31)":[1,0.53],"New Mutator (30)":[-8,3],"New Mutator (32)":[24,0],"New Mutator (34)":[1,1],"New Mutator (33)":[30,-25],"New Mutator (35)":[0,0],"New Mutator (36)":[0,-9],"Lightness (1)":[0.97,0],"Colorize":[0.73,1],"Stretch":[12.85,1],"Saturation (1)":[0.55,0],"Saturation":[0.79,0],"Saturation (2)":[1,0],"Opacity":[1,1],"Lightness (4)":[1,0],"Opacity (1)":[1,1],"Stretch (1)":[1.6,1.6],"Lightness":[1,0],"Opacity (2)":[1,0]},"shapes":[{"type":"sprite","points":[[1696,1056],[1728,1056],[1728,1088],[1696,1088]],"translate":[431,476],"mutationVectors":[{"type":"opacity","origin":[0,0],"name":"New Mutator (12)"}],"name":"Eyes"},{"type":"sprite","points":[[2080,1312],[2080,1664],[2464,1312],[2464,1664]],"translate":[-480,80],"mutationVectors":[{"type":"opacity","origin":[0,0],"name":"Opacity (2)"}],"name":"NightLight"},{"name":"New Folder","type":"folder","items":[{"name":"Overall","type":"folder","items":[{"name":"Bird","type":"folder","items":[{"type":"sprite","points":[[1119,1056],[1120,1068],[1171,1065],[1168,1055]],"translate":[112,-386],"mutationVectors":[{"type":"rotate","origin":[88,-386],"name":"New Mutator (6)"}],"name":"Top"},{"type":"sprite","points":[[1120,1091],[1120,1101],[1151,1101],[1152,1092]],"translate":[104,-384],"mutationVectors":[{"type":"rotate","origin":[90,-384],"name":"New Mutator (7)"}],"name":"Bottom"}],"mutationVectors":[]},{"name":"Vlinder","type":"folder","items":[{"type":"sprite","points":[[63,1352],[137,1356],[143,1311],[65,1308]],"translate":[760,222],"mutationVectors":[{"type":"stretch","origin":[753,241],"name":"New Mutator (13)"}],"name":"Vleugel1"},{"type":"sprite","points":[[61,1376],[61,1358],[130,1363],[130,1379]],"translate":[747,240],"mutationVectors":[],"name":"Lijf"},{"type":"sprite","points":[[63,1352],[137,1356],[143,1311],[65,1308]],"translate":[757,222],"mutationVectors":[{"type":"stretch","origin":[752,243],"name":"New Mutator (14)"}],"name":"Vleugel2"}],"mutationVectors":[{"name":"New Mutator (22)","type":"translate","origin":[0,0],"radius":-1},{"type":"stretch","origin":[765,236],"name":"New Mutator (21)"},{"type":"rotate","origin":[754,244],"name":"New Mutator (15)"}]},{"name":"Tree","type":"folder","items":[{"type":"sprite","points":[[2012,1214],[2016,1361],[2009,1423],[2010,1476],[2002,1510],[2019,1564],[2004,1586],[2000,1626],[2009,1656],[1994,1683],[1994,1716],[1959,1716],[1953,1683],[1955,1620],[1952,1566],[1955,1504],[1957,1433],[1966,1348],[1976,1279],[1975,1240],[1975,1220],[1952,1259],[1945,1283],[1944,1319],[1939,1347],[1932,1385],[1922,1417],[1914,1453],[1901,1483],[1900,1512],[1902,1548],[1911,1582],[1902,1605],[1904,1631],[1904,1663],[1877,1672],[1862,1649],[1861,1593],[1852,1545],[1857,1495],[1863,1458],[1864,1396],[1876,1347],[1861,1353],[1853,1390],[1849,1421],[1852,1453],[1842,1482],[1842,1510],[1846,1540],[1845,1579],[1845,1607],[1849,1635],[1842,1656],[1856,1699],[1833,1715],[1813,1699],[1807,1670],[1802,1632],[1801,1591],[1801,1553],[1803,1512],[1805,1475],[1808,1435],[1808,1397],[1814,1357],[1818,1336],[1802,1330],[1786,1364],[1777,1383],[1780,1407],[1789,1440],[1786,1471],[1769,1501],[1766,1522],[1773,1552],[1782,1589],[1778,1617],[1755,1627],[1736,1611],[1721,1571],[1724,1533],[1727,1499],[1729,1465],[1729,1427],[1733,1393],[1738,1364],[1743,1323],[1752,1294],[1760,1262],[1780,1252],[1811,1261],[1829,1265],[1865,1247],[1786,1229],[1728,1232],[1749,1680]],"translate":[883,-221],"mutationVectors":[{"type":"deform","origin":[906,-79],"name":"New Mutator (5)","radius":298}],"name":"Leaves2"},{"type":"sprite","points":[[1442,1246],[1679,1233],[1654,1356],[1643,1500],[1640,1638],[1642,1721],[1632,1752],[1595,1746],[1579,1705],[1573,1638],[1568,1572],[1569,1508],[1573,1420],[1573,1383],[1564,1412],[1559,1458],[1551,1502],[1552,1545],[1550,1573],[1541,1615],[1540,1647],[1520,1664],[1502,1652],[1497,1617],[1496,1577],[1504,1536],[1504,1497],[1504,1462],[1516,1424],[1520,1388],[1506,1385],[1509,1425],[1498,1452],[1495,1473],[1492,1501],[1485,1513],[1493,1543],[1490,1576],[1469,1580],[1454,1568],[1446,1538],[1444,1500],[1454,1466],[1456,1442],[1451,1401],[1458,1363],[1463,1335],[1424,1274],[1422,1396],[1423,1483],[1427,1557],[1438,1617],[1687,1739],[1678,1603],[1675,1440]],"translate":[901,-220],"mutationVectors":[{"type":"deform","origin":[895,-93],"name":"New Mutator (4)","radius":298}],"name":"Leaves1"}],"mutationVectors":[]},{"name":"Wheel","type":"folder","items":[{"type":"sprite","points":[[947,1271],[1382,1271],[1409,1821],[962,1871]],"translate":[79,56],"mutationVectors":[],"name":"Wheelhouse"},{"name":"Water","type":"folder","items":[{"type":"sprite","points":[[782,1778],[797,1755],[857,1773],[835,1804]],"translate":[95,171],"mutationVectors":[{"name":"New Mutator (38)","type":"translate","origin":[0,0],"radius":-1}],"name":"WaterMove"},{"type":"sprite","points":[[782,1796],[755,1819],[800,1842],[823,1811]],"translate":[73,171],"mutationVectors":[{"name":"New Mutator (39)","type":"translate","origin":[0,0],"radius":-1}],"name":"WaterMove2"},{"type":"sprite","points":[[747,1839],[723,1861],[762,1883],[781,1863]],"translate":[71,172],"mutationVectors":[{"name":"New Mutator (40)","type":"translate","origin":[71,172],"radius":-1}],"name":"WaterMove3"}],"mutationVectors":[]},{"type":"sprite","points":[[1076,1892],[1187,1888],[1192,1978],[1073,1983]],"translate":[33,193],"mutationVectors":[],"name":"Hider"},{"type":"sprite","points":[[340,1312],[703,1312],[703,1675],[340,1675]],"translate":[142,5],"mutationVectors":[{"type":"stretch","origin":[141,4],"name":"New Mutator"},{"type":"rotate","origin":[141,4],"name":"New Mutator (2)"}],"name":"WheelRight"},{"type":"sprite","points":[[775,1306],[899,1303],[907,1682],[771,1678]],"translate":[102,6],"mutationVectors":[],"name":"Side"},{"name":"Blades","type":"folder","items":[{"type":"sprite","points":[[63,1216],[63,1269],[185,1216],[184,1269]],"translate":[48,56],"mutationVectors":[{"name":"New Mutator (30)","type":"translate","origin":[48,56],"radius":-1},{"type":"stretch","origin":[-12,82],"name":"New Mutator (31)"},{"name":"New Mutator (32)","type":"translate","origin":[-12,31],"radius":6}],"name":"Blade3"},{"type":"sprite","points":[[63,1216],[63,1269],[185,1216],[184,1269]],"translate":[105,142],"mutationVectors":[{"name":"New Mutator (24)","type":"translate","origin":[0,0],"radius":-1},{"type":"stretch","origin":[97,168],"name":"New Mutator (25)"},{"name":"New Mutator (26)","type":"translate","origin":[46,113],"radius":24}],"name":"Blade1"},{"type":"sprite","points":[[63,1216],[63,1269],[185,1216],[184,1269]],"translate":[71,122],"mutationVectors":[{"name":"New Mutator (27)","type":"translate","origin":[0,0],"radius":-1},{"type":"stretch","origin":[62,152],"name":"New Mutator (29)"},{"name":"New Mutator (28)","type":"translate","origin":[14,98],"radius":16}],"name":"Blade2"},{"type":"sprite","points":[[63,1216],[63,1269],[185,1216],[184,1269]],"translate":[0,0],"mutationVectors":[{"name":"New Mutator (33)","type":"translate","origin":[0,0],"radius":-1},{"type":"stretch","origin":[-60,27],"name":"New Mutator (34)"},{"name":"New Mutator (35)","type":"translate","origin":[-61,-27],"radius":8}],"name":"Blade4"},{"type":"sprite","points":[[63,1216],[63,1269],[185,1216],[184,1269]],"translate":[107,149],"mutationVectors":[{"name":"New Mutator (37)","type":"translate","origin":[0,0],"radius":-1}],"name":"Blade5"}],"mutationVectors":[]},{"type":"sprite","points":[[340,1312],[703,1312],[703,1675],[340,1675]],"translate":[48,0],"mutationVectors":[{"type":"stretch","origin":[48,0],"name":"New Mutator (1)"},{"type":"rotate","origin":[48,0],"name":"New Mutator (3)"}],"name":"WheelLeft"}],"mutationVectors":[]},{"type":"sprite","points":[[814,123],[869,119],[930,128],[934,133],[936,264],[810,268]],"translate":[-151,-319],"mutationVectors":[],"name":"Schoorsteen"},{"type":"sprite","points":[[96,1696],[96,1440],[236,1440],[236,1696],[96,1664],[96,1472],[96,1504],[96,1536],[96,1568],[96,1600],[96,1632],[236,1472],[236,1504],[236,1536],[236,1568],[236,1600],[236,1632],[236,1664],[46,1696],[46,1630],[46,1440],[46,1568],[46,1504],[285,1440],[285,1504],[285,1568],[285,1632],[285,1696]],"translate":[-147,-384],"mutationVectors":[{"type":"deform","origin":[-227,-407],"name":"New Mutator (18)","radius":64},{"type":"deform","origin":[-73,-496],"name":"New Mutator (17)","radius":63},{"name":"New Mutator (16)","type":"translate","origin":[0,0],"radius":-1}],"name":"Rook"},{"type":"sprite","points":[[1129,1236],[1129,1201],[1125,1160],[1141,1159],[1143,1197],[1145,1237],[1160,1238],[1158,1199],[1161,1160],[1175,1159],[1173,1200],[1174,1240]],"translate":[325,-77],"mutationVectors":[{"type":"deform","origin":[326,-121],"name":"New Mutator (23)","radius":55}],"name":"Sigar"},{"type":"sprite","points":[[847,1204],[853,1204],[853,1217],[848,1217],[843,1220],[845,1229],[858,1227]],"translate":[-356,-247],"mutationVectors":[{"name":"New Mutator (36)","type":"translate","origin":[-356,-241],"radius":9}],"name":"Spider"},{"type":"sprite","points":[[0,0],[0,1024],[2048,1024],[2048,0]],"translate":[0,0],"mutationVectors":[],"name":"Background"}],"mutationVectors":[{"type":"saturation","origin":[0,0],"name":"Saturation (2)"},{"type":"lightness","origin":[0,0],"name":"Lightness (1)"}]},{"name":"SatLayer","type":"folder","items":[{"type":"sprite","points":[[277,1220],[295,1149],[308,1110],[345,1126],[350,1160],[345,1201],[331,1226],[387,1236],[379,1191],[379,1138],[398,1097],[423,1071],[449,1103],[457,1134],[457,1167],[463,1211],[454,1240],[502,1244],[493,1212],[490,1173],[495,1127],[502,1087],[528,1079],[566,1097],[571,1139],[587,1175],[582,1211],[562,1240],[622,1177],[621,1146],[621,1111],[643,1079],[672,1109],[680,1147],[651,1178],[678,1195],[693,1138],[706,1124],[706,1088],[724,1090],[737,1112],[744,1135],[747,1169],[728,1198]],"translate":[429,-310],"mutationVectors":[{"type":"deform","origin":[289,-335],"name":"New Mutator (8)","radius":73},{"type":"deform","origin":[453,-353],"name":"New Mutator (9)","radius":83},{"type":"deform","origin":[600,-355],"name":"New Mutator (10)","radius":66}],"name":"BackTrees"},{"type":"sprite","points":[[2080,1664],[2080,1920],[2624,1664],[2624,1920]],"translate":[-752,-253],"mutationVectors":[],"name":"Left (1)"},{"type":"sprite","points":[[3168,1664],[3168,1920],[4064,1952],[4064,1664]],"translate":[512,-237],"mutationVectors":[],"name":"Right (1)"}],"mutationVectors":[{"type":"lightness","origin":[0,0],"name":"Lightness (4)"},{"type":"saturation","origin":[0,0],"name":"Saturation"}]},{"name":"Mountains","type":"folder","items":[{"name":"Clouds","type":"folder","items":[{"type":"sprite","points":[[1038,1136],[758,1140],[758,1070],[1021,1065]],"translate":[77,-454],"mutationVectors":[{"name":"New Mutator (11)","type":"translate","origin":[0,0],"radius":-1}],"name":"Cloud1"},{"type":"sprite","points":[[1251,1049],[1258,1119],[1464,1119],[1447,1055]],"translate":[906,-458],"mutationVectors":[{"name":"New Mutator (19)","type":"translate","origin":[0,0],"radius":-1}],"name":"Cloud2"},{"type":"sprite","points":[[62,1106],[63,1159],[237,1158],[231,1107]],"translate":[-603,-444],"mutationVectors":[{"name":"New Mutator (20)","type":"translate","origin":[0,0],"radius":-1}],"name":"Could3"}],"mutationVectors":[]},{"type":"sprite","points":[[288,1760],[288,1920],[32,1920],[32,1760]],"translate":[-568,-264],"mutationVectors":[],"name":"Left"},{"type":"sprite","points":[[320,1760],[320,1920],[576,1920],[576,1760]],"translate":[759,-330],"mutationVectors":[],"name":"Right"}],"mutationVectors":[{"type":"lightness","origin":[0,0],"name":"Lightness"},{"type":"saturation","origin":[0,0],"name":"Saturation (1)"}]}],"mutationVectors":[{"type":"colorize","origin":[1,1],"name":"Colorize"}]},{"type":"sprite","points":[[1632,1056],[1536,1056],[1536,1152],[1632,1152]],"translate":[-821,-459],"mutationVectors":[{"name":"Translation","type":"translate","origin":[0,0],"radius":-1}],"name":"Sun"},{"name":"New Folder (1)","type":"folder","items":[{"type":"sprite","points":[[2112,32],[2272,32],[2272,352],[2112,352]],"translate":[-14,-352],"mutationVectors":[{"type":"opacity","origin":[1,1],"name":"Opacity"}],"name":"Sky"},{"type":"sprite","points":[[2464,352],[2304,352],[2304,32],[2464,32]],"translate":[-14,-352],"mutationVectors":[{"type":"opacity","origin":[0,0],"name":"Opacity (1)"}],"name":"Sky2"}],"mutationVectors":[{"type":"stretch","origin":[-15,-323],"name":"Stretch"}]},{"name":"New Folder (2)","type":"folder","items":[{"type":"sprite","points":[[2496,32],[2496,352],[2976,352],[2976,32]],"translate":[-777,-358],"mutationVectors":[],"name":"Stars"},{"type":"sprite","points":[[2496,32],[2496,352],[2976,352],[2976,32]],"translate":[-298,-387],"mutationVectors":[],"name":"Stars (1)"},{"type":"sprite","points":[[2496,32],[2496,352],[2976,352],[2976,32]],"translate":[22,-423],"mutationVectors":[],"name":"Stars (1) (1)"}],"mutationVectors":[{"type":"stretch","origin":[-1017,-511],"name":"Stretch (1)"}]}],"version":"1.0"}')),W=t(O()+"innkeeper.2658dcad.png"),G=t(JSON.parse('{"animations":[{"name":"Eye blink","looping":true,"keyframes":[{"time":2500,"controlValues":{"LeftEyeClose":0,"RightEyeClose":0}},{"time":2750,"controlValues":{"LeftEyeClose":1,"RightEyeClose":1}},{"time":3000,"controlValues":{"RightEyeClose":0,"LeftEyeClose":0}}]},{"name":"Look around","looping":true,"keyframes":[{"time":1000,"controlValues":{"LeftEye-x":0.18,"RightEye-x":0.24}},{"time":2000,"controlValues":{"LeftEye-x":1,"RightEye-x":1.02}},{"time":3980,"controlValues":{"LeftEye-x":1.02,"RightEye-x":1}},{"time":5000,"controlValues":{"RightEye-x":1.8,"LeftEye-x":1.84}},{"time":6000,"controlValues":{"LeftEye-x":0.98,"RightEye-x":1.06}},{"time":8000,"controlValues":{"RightEye-x":1,"LeftEye-x":1}}]},{"name":"Talking","looping":true,"keyframes":[{"time":1000,"controlValues":{"Mouth":0}},{"time":1340,"controlValues":{"Mouth":0.62}},{"time":1670,"controlValues":{"Mouth":0}},{"time":2120,"controlValues":{"Mouth":0}},{"time":2430,"controlValues":{"Mouth":0.68}},{"time":2790,"controlValues":{"Mouth":0.24}},{"time":3160,"controlValues":{"Mouth":1}},{"time":3470,"controlValues":{"Mouth":0}}]},{"name":"No","looping":false,"keyframes":[{"time":510,"controlValues":{"HeadTurn":0.38}},{"time":1270,"controlValues":{"HeadTurn":0}},{"time":2180,"controlValues":{"HeadTurn":1}},{"time":2990,"controlValues":{"HeadTurn":0}},{"time":3980,"controlValues":{"HeadTurn":0.48}}]},{"name":"HeadTilt","looping":true,"keyframes":[{"time":1000,"controlValues":{"HeadTilt":0.42}},{"time":6000,"controlValues":{"HeadTilt":0.53}},{"time":9000,"controlValues":{"HeadTilt":0.14}},{"time":12000,"controlValues":{"HeadTilt":0.43}}]},{"name":"EyeWink","looping":false,"keyframes":[{"time":500,"controlValues":{"RightEyeClose":0,"LeftEyeClose":0}},{"time":800,"controlValues":{"RightEyeClose":1}},{"time":1200,"controlValues":{"RightEyeClose":1}},{"time":1500,"controlValues":{"RightEyeClose":0}}]},{"name":"Eyebrows","looping":true,"keyframes":[{"time":990,"controlValues":{"Eyebrows":1.32}},{"time":3940,"controlValues":{"Eyebrows":0.92}},{"time":6820,"controlValues":{"Eyebrows":1.88}},{"time":10220,"controlValues":{"Eyebrows":0.88}}]},{"name":"Sweeping","looping":true,"keyframes":[{"time":1000,"controlValues":{"Broom":0.69,"ArmRightBottom":0.46,"ArmRightTop":0.14,"ArmLeftBottom":0.19,"ArmLeftTop":0.9,"Dust":1}},{"time":2000,"controlValues":{"Broom":1,"ArmRightBottom":0.79,"ArmRightTop":0.09,"ArmLeftBottom":0.13,"ArmLeftTop":0.71}},{"time":2499,"controlValues":{"Dust":1}},{"time":2500,"controlValues":{"ArmLeftTop":0.92,"ArmLeftBottom":0.18,"ArmRightTop":0.1,"ArmRightBottom":0.59,"Broom":0.69,"Dust":0}},{"time":3000,"controlValues":{"Broom":0,"ArmRightBottom":0.58,"ArmRightTop":0,"ArmLeftBottom":0.26,"ArmLeftTop":1,"Dust":1}}]},{"name":"StopTalking","looping":false,"keyframes":[{"time":470,"controlValues":{"Mouth":0}}]},{"name":"EyebrowReset","looping":false,"keyframes":[{"time":560,"controlValues":{"Eyebrows":1}}]},{"name":"PauseSweeping","looping":false,"keyframes":[{"time":1460,"controlValues":{"Broom":0.86,"ArmRightBottom":0.22,"ArmRightTop":0.13,"ArmLeftBottom":0.48,"ArmLeftTop":0.96}}]}],"controlValues":{"Eyebrows":1,"HeadTilt":0.55,"HeadTurn":0.5,"Mouth":0,"RightEye-y":0.5,"LeftEye-y":0.5,"RightEye-x":1,"LeftEye-x":1,"RightEyeClose":0,"LeftEyeClose":0,"ArmTop":0,"ArmBottom":1,"ArmLeftTop":0.83,"ArmLeftBottom":0.31,"ArmRightTop":0.07,"ArmRightBottom":0.58,"Broom":1,"Dust":1},"controls":[{"name":"Dust","type":"slider","steps":[{"c":[0.35,0.05],"a":[143,0],"b":[1,1]},{"c":[1,1],"a":[-1110,0],"b":[0,0]}]},{"name":"Broom","type":"slider","steps":[{"i":[-29,0],"h":[-131,-39]},{"i":[8,0],"h":[0,0]}]},{"name":"ArmRightBottom","type":"slider","steps":[{"e":[-122,0]},{"e":[9,0]}]},{"name":"ArmRightTop","type":"slider","steps":[{"H":[-18,0],"d":[-18,0]},{"H":[100,0],"d":[100,0]}]},{"name":"ArmLeftBottom","type":"slider","steps":[{"g":[52,0]},{"g":[-108,0]}]},{"name":"ArmLeftTop","type":"slider","steps":[{"I":[-85,0],"f":[-84,0]},{"I":[8,0],"f":[8,0]}]},{"name":"Eyebrows","type":"slider","steps":[{"p":[0,6],"q":[-10,0],"r":[0,6],"s":[10,0]},{"p":[0,0],"q":[0,0],"r":[0,0],"s":[0,0]},{"p":[0,0],"q":[9,0],"r":[0,0],"s":[-9,0]}]},{"name":"HeadTilt","type":"slider","steps":[{"K":[15,0],"j":[15,0],"m":[-34,0],"l":[-29,0],"J":[-75,0]},{"j":[-15,0],"K":[-15,0],"m":[32,0],"l":[42,0],"J":[103,0]}]},{"name":"HeadTurn","type":"slider","steps":[{"w":[-9,0],"x":[-2,0],"o":[7,0],"k":[3,0],"n":[2,0],"L":[-7,0],"F":[1,0],"C":[1,0]},{"o":[-5,0],"w":[3,0],"x":[7,0],"k":[-3,0],"n":[-2,0],"L":[10,0],"C":[-1,0],"F":[-1,0]}]},{"name":"Mouth","type":"slider","steps":[{"A":[1,1],"z":[1,1],"v":[0,0],"y":[0,0]},{"A":[1,1.1],"z":[1,3.85],"v":[0,-20],"y":[0,3]}]},{"name":"RightEye-y","type":"slider","steps":[{"C":[0,-8]},{"C":[0,11]}]},{"name":"LeftEye-y","type":"slider","steps":[{"F":[0,-7]},{"F":[0,11]}]},{"name":"RightEye-x","type":"slider","steps":[{"C":[-7,0],"D":[0.85,1]},{"C":[1,0],"D":[1,1]},{"C":[13,0],"D":[0.85,1]}]},{"name":"LeftEye-x","type":"slider","steps":[{"F":[-12,0],"G":[0.85,1]},{"G":[1,1],"F":[0,0]},{"F":[9,0],"G":[0.85,1]}]},{"name":"RightEyeClose","type":"slider","steps":[{"u":[1,1],"B":[0,0]},{"B":[0,48],"u":[1,-1.2]}]},{"name":"LeftEyeClose","type":"slider","steps":[{"E":[0,0],"t":[1,1]},{"t":[1,-1.1],"E":[0,50]}]}],"defaultFrame":{"B":[0,-29],"u":[1,1],"D":[1,1],"C":[0,0],"E":[0,-25],"t":[1,1],"G":[1,1],"F":[0,0],"A":[1,1],"z":[1,0.25],"v":[0,0],"j":[-1,0],"K":[0,0],"m":[0,0],"l":[0,0],"J":[0,0],"q":[0,0],"p":[0,0],"s":[0,0],"r":[0,0],"g":[97,0],"i":[16,0],"I":[0,0],"f":[0,0],"H":[0,0],"d":[0,0],"e":[0,0],"b":[1,1],"c":[1,1]},"shapes":[{"type":"sprite","points":[[1408,224],[1216,32],[1984,32],[1984,224]],"translate":[141,1666],"mutationVectors":[{"name":"a","type":"translate","origin":[228,0],"radius":-1},{"type":"opacity","origin":[228,0],"name":"b"},{"type":"stretch","origin":[236,1751],"name":"c"}],"name":"a"},{"name":"b","type":"folder","items":[{"type":"sprite","points":[[92,688],[139,676],[186,690],[173,869],[70,764],[144,904],[94,908]],"translate":[277,593],"mutationVectors":[],"name":"c"},{"type":"sprite","points":[[452,597],[529,600],[413,697],[435,747],[516,759],[537,704]],"translate":[271,719],"mutationVectors":[],"name":"d"}],"mutationVectors":[{"type":"rotate","origin":[192,279],"name":"d"},{"type":"rotate","origin":[282,489],"name":"e"}]},{"name":"e","type":"folder","items":[{"type":"sprite","points":[[80,1054],[183,1046],[202,1203],[182,1283],[123,1289],[83,1174]],"translate":[-230,584],"mutationVectors":[],"name":"f"},{"type":"sprite","points":[[212,1432],[229,1591],[94,1596],[109,1435]],"translate":[-224,748],"mutationVectors":[],"name":"g"}],"mutationVectors":[{"type":"rotate","origin":[-148,286],"name":"f"},{"type":"rotate","origin":[-245,483],"name":"g"}]},{"type":"sprite","points":[[552,363],[633,363],[635,1808],[770,2028],[725,2040],[552,2010],[503,1913]],"translate":[157,958],"mutationVectors":[{"name":"h","type":"translate","origin":[0,0],"radius":-1},{"type":"rotate","origin":[128,682],"name":"i"}],"name":"h"},{"name":"i","type":"folder","items":[{"type":"sprite","points":[[1013,495],[1023,467],[1021,419],[1024,374],[1023,323],[1000,281],[955,263],[888,267],[836,303],[817,354],[813,412],[811,457],[822,473],[840,459],[847,431],[854,398],[856,368],[912,338],[917,361],[934,337],[971,345],[998,363],[998,409],[994,435],[999,471]],"translate":[-6,-36],"mutationVectors":[{"type":"deform","origin":[-98,48],"name":"l","radius":96},{"type":"deform","origin":[87,54],"name":"m","radius":101},{"name":"n","type":"translate","origin":[0,0],"radius":-1}],"name":"j"},{"type":"sprite","points":[[221,213],[265,212],[266,230],[223,233]],"translate":[2,46],"mutationVectors":[{"name":"o","type":"translate","origin":[0,0],"radius":-1}],"name":"k"},{"type":"sprite","points":[[776,110],[780,98],[793,90],[805,91],[818,92],[830,95],[842,106],[833,114],[818,110],[795,108]],"translate":[-42,-46],"mutationVectors":[{"name":"p","type":"translate","origin":[0,0],"radius":-1},{"type":"rotate","origin":[-55,-48],"name":"q"}],"name":"l"},{"type":"sprite","points":[[774,139],[783,154],[794,148],[810,146],[824,148],[837,150],[837,139],[825,132],[808,129],[788,132]],"translate":[41,-43],"mutationVectors":[{"name":"r","type":"translate","origin":[0,0],"radius":-1},{"type":"rotate","origin":[54,-44],"name":"s"}],"name":"m"},{"name":"n","type":"sprite","points":[[679,86],[679,108],[738,111],[736,86]],"translate":[-47,-13],"mutationVectors":[{"type":"stretch","origin":[-47,-6],"name":"t","radius":-1}]},{"name":"o","type":"sprite","points":[[613,106],[668,108],[667,86],[611,84]],"translate":[43,-14],"mutationVectors":[{"type":"stretch","origin":[37,-6],"name":"u","radius":-1}]},{"name":"p","type":"sprite","points":[[431,266],[485,277],[509,270],[507,259],[435,255],[481,248],[462,248],[462,277],[572,54],[373,52],[572,272],[375,277]],"translate":[2,-34],"mutationVectors":[{"type":"deform","origin":[2,79],"name":"v","radius":26}]},{"type":"sprite","points":[[128,165],[135,173],[145,170],[162,129],[160,113],[151,102],[134,113],[130,121]],"translate":[93,-3],"mutationVectors":[{"name":"w","type":"translate","origin":[0,0],"radius":-1}],"name":"q"},{"type":"sprite","points":[[103,111],[112,168],[103,176],[92,174],[74,110],[86,104]],"translate":[-91,-6],"mutationVectors":[{"name":"x","type":"translate","origin":[0,0],"radius":-1}],"name":"r"},{"name":"s","type":"sprite","points":[[636,235],[717,236],[717,247],[694,256],[653,256],[636,245]],"translate":[0,65],"mutationVectors":[{"name":"y","type":"translate","origin":[0,0]}]},{"name":"t","type":"sprite","points":[[759,189],[761,210],[770,228],[785,235],[814,235],[833,232],[844,218],[847,194]],"translate":[0,83],"mutationVectors":[{"type":"stretch","origin":[1,65],"name":"z","radius":-1}]},{"name":"u","type":"sprite","points":[[612,266],[787,262],[777,310],[737,355],[701,362],[662,352],[622,313]],"translate":[0,87],"mutationVectors":[{"type":"stretch","origin":[0,40],"name":"A","radius":-1}]},{"name":"v","type":"folder","items":[{"name":"w","type":"sprite","points":[[618,149],[664,142],[657,131],[646,128],[630,128],[620,138],[634,149],[645,148]],"translate":[41,-11],"mutationVectors":[{"type":"deform","origin":[38,-6],"name":"B","radius":15}]},{"name":"x","type":"sprite","points":[[624,79],[630,79],[630,71],[621,71]],"translate":[30,-10],"mutationVectors":[]},{"name":"y","type":"sprite","points":[[653,186],[653,160],[627,160],[627,186]],"translate":[37,-9],"mutationVectors":[{"name":"C","type":"translate","origin":[0,0]},{"type":"stretch","origin":[38,-9],"name":"D","radius":-1}]},{"name":"z","type":"sprite","points":[[621,197],[620,228],[667,197],[666,227]],"translate":[40,-6],"mutationVectors":[]}],"mutationVectors":[]},{"name":"A","type":"folder","items":[{"name":"B","type":"sprite","points":[[688,143],[695,131],[709,127],[721,129],[731,136],[736,151],[704,146],[716,148]],"translate":[-42,-12],"mutationVectors":[{"type":"deform","origin":[-42,-9],"name":"E","radius":15}]},{"name":"C","type":"sprite","points":[[697,77],[705,78],[706,70],[697,70]],"translate":[-48,-12],"mutationVectors":[]},{"name":"D","type":"sprite","points":[[698,161],[698,186],[724,186],[724,161]],"translate":[-42,-11],"mutationVectors":[{"name":"F","type":"translate","origin":[0,0]},{"type":"stretch","origin":[-41,-10],"name":"G","radius":-1}]},{"name":"E","type":"sprite","points":[[685,197],[685,227],[734,229],[733,197]],"translate":[-43,-6],"mutationVectors":[]}],"mutationVectors":[]}],"mutationVectors":[{"type":"rotate","origin":[-5,98],"name":"j"},{"name":"k","type":"translate","origin":[0,0],"radius":-1}]},{"type":"sprite","points":[[1214,246],[2027,1820],[1738,244],[961,1842],[1620,334],[1681,336],[1678,350],[1629,369]],"translate":[14,896],"mutationVectors":[],"name":"F"},{"type":"sprite","points":[[325,586],[430,939],[384,658],[320,941],[198,687],[197,654],[269,585]],"translate":[227,359],"mutationVectors":[{"type":"rotate","origin":[192,279],"name":"H"}],"name":"G"},{"type":"sprite","points":[[415,1020],[482,1105],[434,1125],[335,1373],[268,1384],[238,1331],[284,1061],[346,1031]],"translate":[-173,354],"mutationVectors":[{"type":"rotate","origin":[-148,286],"name":"I"}],"name":"H"},{"type":"sprite","points":[[779,611],[822,582],[864,568],[921,567],[979,582],[1013,632],[1042,707],[1038,813],[1028,847],[1040,912],[1030,948],[1027,1024],[990,1103],[954,1120],[907,1064],[867,1106],[822,1083],[779,1105],[750,1084],[754,992],[743,934],[759,844],[753,753],[761,709],[747,660]],"translate":[-2,108],"mutationVectors":[{"type":"deform","origin":[-7,263],"name":"J","radius":331},{"type":"rotate","origin":[-3,106],"name":"K"},{"name":"L","type":"translate","origin":[0,0],"radius":-1}],"name":"I"}],"version":"1.0"}'));let Y=[];const K=t=>{Y=Y.filter((e=>e.name!==t))},j=(t,e,a,o,n)=>new Promise((r=>{K(t);let i=e;Y=Y.concat({name:t,ticker:()=>{i===a?(K(t),r()):i<a?i+=Math.min(o,a-i):i-=Math.min(o,i-a),n(i)}})})),J=(t,e)=>new Promise((a=>{K(t);let o=e;Y=Y.concat({name:t,ticker:()=>{0===o?(K(t),a()):o--}})})),Z=document.getElementById("root"),q=(t,e)=>async a=>{t.startTrack("Talking",{startAt:800}),t.startTrack("Eyebrows");const o=(t=>{const a=document.createElement("div");a.classList.add("dialogbox");const o=document.createElement("h3");o.classList.add("dialogname"),o.textContent=e,a.appendChild(o),Z.appendChild(a);const n=document.createElement("p");return n.textContent=t,a.appendChild(n),()=>{Z.removeChild(a)}})(a);(async e=>{await J("talking",6*e.length),t.startTrack("StopTalking"),t.startTrack("EyebrowReset")})(a),await(async()=>new Promise((t=>{const e=document.getElementsByClassName("dialogbox")[0],a=()=>{t(),e.removeEventListener("click",a)};e.addEventListener("click",a)})))(),t.startTrack("StopTalking"),t.startTrack("EyebrowReset"),o()},Q=async t=>{let e=!0;const a={endDialog:()=>{e=!1}};for(;e;){const e=document.createElement("div");e.classList.add("choicebox"),Z.appendChild(e);const o=await new Promise((a=>{Object.keys(t).forEach((t=>{const o=document.createElement("button");o.textContent=t,o.addEventListener("click",(()=>{Z.removeChild(e),setTimeout((()=>{a(t)}))})),e.appendChild(o)}))}));await t[o](a)}},$=["Hi! Welcome adventurer, welcome to my inn! Is there something you want to know?",{"What is Geppetto?":["Geppetto consists of two parts. A desktop application to define animated images, and a JavaScript library to play them.",{"Is Geppetto free?":["Yes! It is free to use and distribute. It's also opensource (MIT License). So everyone can see how it works and extend it."],"How does it work?":["You need to create a texture file as .PNG. in Geppetto you will make layers from your texture, and compose them into your image.","The next step is to add mutations to your layer tree to create motion. You can then create timelines to define multiple animations.",{"Why not [Other product here]?":["Other solutions exist for animation. Some are paid, some are not open source, some use vector graphics.","Using a single texture file is fast (single http request) and adding more detail to your image doesn't have any rendering cost."],"What are the features?":["Real-time control and animations. Did you know I can look in the direction you click in this image?","Smooth transition between animations.","Fast, most of the processing is on the GPU","Free as in beer and speech. Isn't that great! It also means Matthijs doesn't make any money from it, and only works on it in his free time. But, feel free to contribute!"],"Sounds great!":["END"]}],"I want to talk about something else":["END"]}],"What can you tell me about your world?":["I hope the world I live in will be expanded into a full game! Wouldn't that be great?","For now it functions as a demo, to see if a game like environment could be created.","Can you spot all the moving elements?","END"],"I think I'll start exploring!":["Good luck!","END"]}],tt=async(t,e)=>{for(const a of t)if("string"==typeof a&&"END"!==a&&await e(a),"object"==typeof a){const t=Object.entries(a).reduce(((t,[a,o])=>({...t,[a]:async({endDialog:t})=>{await tt(o,e),"END"===o[o.length-1]&&t()}})),{});await Q(t)}},et=document.getElementById("theatre"),at=(t=>{const e=U(t);return e.clearColor(0,0,0,1),e.enable(e.DEPTH_TEST),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),P(t)})(et),ot=async t=>new Promise((e=>{const a=new Image;a.crossOrigin="anonymous",a.src=t,a.onload=()=>e(a)}));(async()=>{const t=await ot(H),e=A(X),a=at.addAnimation(e,t,0,{zoom:2,panX:0}),o=await ot(W),n=A(G),r={zoom:.26,panX:-2.1,panY:-.5,zIndex:2},i=2.2,s=-.3,l=.1,u=at.addAnimation(n,o,1,r),m=()=>{const t=et.getBoundingClientRect(),e=navigator.userAgent.includes("SMART-TV")?2:1;et.width=Math.min(2048,t.width*window.devicePixelRatio*e),et.height=Math.min(1024,t.height*window.devicePixelRatio*e)};m(),window.addEventListener("resize",(()=>{m()})),a.startTrack("Wheel"),a.startTrack("WheelBlades"),a.startTrack("Tree"),a.startTrack("Bird"),a.startTrack("Cloud1",{speed:.15}),a.startTrack("Cloud2",{speed:.1}),a.startTrack("Cloud3",{speed:.15}),a.startTrack("Day night",{speed:.125}),a.startTrack("Eyes"),a.startTrack("Smoke"),a.startTrack("Water"),a.onEvent((t=>{"evening"===t&&(a.startTrack("LightFlicker"),a.stopTrack("Bird")),"endNight"===t&&a.startTrack("LightOff"),"morning"===t&&a.startTrack("Bird")}));let c=!0;u.startTrack("Eye blink"),u.startTrack("HeadTilt"),u.startTrack("Sweeping");(()=>{let t=[0,0];const e=[.145,.388],a=(e,a)=>Promise.all([j("eye-X",t[0],e,.025,(e=>{t[0]=e,u.setControlValue("RightEye-x",e+1),u.setControlValue("LeftEye-x",e+1),u.setControlValue("HeadTurn",1-.5*(e+1))})),j("eye-Y",t[1],a,.025,(e=>{t[1]=e,u.setControlValue("RightEye-y",.5*(e+1)),u.setControlValue("LeftEye-y",.5*(e+1))}))]).then((()=>{}));et.addEventListener("click",(async t=>{const o=et.getBoundingClientRect(),n=[t.x/o.width,t.y/o.height];if(n[0]>.203&&n[0]<.263&&n[1]>.458&&n[1]<.706&&c)return u.setZoom(i),u.setPanning(s,l),c=!1,void(async t=>{await J("startTalking",60),t.startTrack("PauseSweeping");const e=q(t,"Innkeeper");await tt($,e)})(u).then((()=>{u.setZoom(r.zoom),u.setPanning(r.panX,r.panY),c=!0,u.startTrack("Sweeping")}));const m=Math.min(1,Math.max(-1,(n[0]-e[0])/.4)),p=Math.min(1,Math.max(-1,(n[1]-e[1])/.4));K("resetDelay"),await a(m,p),await J("resetDelay",180),await a(0,-.1)})),a(0,-.1)})(),(async()=>{const t=.0025,e={x:.72,y:.87,z:.8},o=.51,n=.29,r=.95,i={...e};a.setControlValue("ButterflyX",i.x),a.setControlValue("ButterflyY",i.y),a.setControlValue("ButterflyZoom",i.z),a.startTrack("ButterflyWings",{speed:.2}),await J("bfParked",320);let s=!1;const l=(e,o,n)=>(s||(a.startTrack("ButterflyWings"),s=!0),e<i.x?a.setControlValue("ButterflyTurn",0):a.setControlValue("ButterflyTurn",1),Promise.all([j("ButterflyX",i.x,e,t,(t=>{i.x=t,a.setControlValue("ButterflyX",t)})),j("ButterflyY",i.y,o,t,(t=>{i.y=t,a.setControlValue("ButterflyY",t)})),j("ButterflyZoom",i.z,n,.025,(t=>{i.z=t,a.setControlValue("ButterflyZoom",t)}))])),u=()=>{const t=.3*Math.random();let e=Math.random()>.5?1:-1,a=Math.random()>.5?1:-1;(i.x+e*t>1||i.x+e*t<0)&&(e*=-1),(i.y+a*t>1||i.y+a*t<0)&&(a*=-1);const o=i.x+e*t,n=i.y+a*t,r=Math.min(Math.max(i.z+Math.random()*t,0),1);return l(o,n,r)};for(;;){const t=Math.random();t>.95?(await l(e.x,e.y,e.z),s&&(a.startTrack("ButterflyWings",{speed:.2}),s=!1),await J("bfParked",320)):t<.05?(await l(o,n,r),s&&(a.startTrack("ButterflyWings",{speed:.2}),s=!1),await J("bfParked",320)):await u()}})();const p=()=>{(()=>{for(const t of Y)t.ticker()})(),at.render(),a.render(),u.render(),window.requestAnimationFrame(p)};window.requestAnimationFrame(p)})();
//# sourceMappingURL=index.27f846c9.js.map
